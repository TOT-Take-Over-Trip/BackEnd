<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.trip.post.model.mapper.PostMapper">

  <resultMap type="postDto" id="post">
    <result column="post_id" property="postId" />
    <result column="member_id" property="memberId" />
    <result column="title" property="title" />
    <result column="content" property="content" />
    <result column="thumbnail" property="thumbnail" />
    <result column="post_like_count" property="postLikeCount" />
    <result column="created_date" property="createdDate" />
    <result column="updated_date" property="updatedDate" />
    <result column="status" property="status" />
  </resultMap>
  
  <resultMap type="PostCommentDto" id="postComment">
    <result column="post_comment_id" property="postCommentId" />
    <result column="post_id" property="postId" />
    <result column="member_id" property="memberId" />
    <result column="content" property="content" />
    <result column="created_date" property="createdDate" />
    <result column="updated_date" property="updatedDate" />
    <result column="status" property="status" />
  </resultMap>

  <select id="selectAllPosts" resultMap="post">
    SELECT
      post_id, member_id, title, content, thumbnail, post_like_count, created_date, updated_date, status
    FROM
      post
    WHERE status = 'active'
  </select>

  <select id="selectPostById" parameterType="int" resultMap="post">
    SELECT
      post_id, member_id, title, content, thumbnail, post_like_count, created_date, updated_date, status
    FROM
      post
    WHERE
      post_id = #{postId}
  </select>

  <select id="selectPostCommentsById" parameterType="int" resultMap="postComment">
    SELECT
      post_comment_id, post_id, member_id, content, created_date, updated_date, status
    FROM
      post_comment
    WHERE
      post_id = #{postId}
  </select>
  
  <insert id="insertPost" parameterType="PostDto">
    INSERT INTO Post(member_id, title, content, thumbnail)
    VALUES(#{memberId}, #{title}, #{content}, #{thumbnail})
  </insert>

  <update id="updatePost" parameterType="PostDto">
    UPDATE
      POST
    SET
      title = #{title}
      ,   content = #{content}
      ,       created_date = #{createdDate}
      ,       updated_date = #{updatedDate}
      ,       status = #{status}
    WHERE
      post_id = #{postId}
  </update>

  <update id="deletePostById" parameterType="int">
    UPDATE
      POST
    SET
      status = #{status}
    WHERE
      post_id = #{postId}
  </update>

</mapper>